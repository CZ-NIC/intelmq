#!/usr/bin/env python
# -*- coding: utf-8 -*-
"""
Created on Fri Sep 11 14:13:21 2015

@author: sebastian
"""
from __future__ import unicode_literals, print_function

import psycopg2


from intelmq import RUNTIME_CONF_FILE
import intelmq.lib.utils as utils


DBPARAMS = utils.load_configuration(RUNTIME_CONF_FILE)['postgresql-output']
DBTABLE = DBPARAMS['table']
CON = psycopg2.connect(database=DBPARAMS['database'],
                       user=DBPARAMS['user'],
                       password=DBPARAMS['password'],
                       host=DBPARAMS['host'],
                       port=DBPARAMS['port'],
                       sslmode=DBPARAMS['sslmode'],
                       )
CUR = CON.cursor()
QUERY = """
SELECT COUNT(*)
FROM {}
WHERE
    notify = TRUE;
""".format(DBTABLE)


def count_all():
    CUR.execute(QUERY)
    print(CUR.fetchall())

if __name__ == '__main__':
    count_all()
